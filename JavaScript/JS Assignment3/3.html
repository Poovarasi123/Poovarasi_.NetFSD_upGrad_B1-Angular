<!DOCTYPE html>
<html>
<head>
    <title>Location Logger</title>
</head>
<body>

<h2>Location-Based Logger</h2>

<button onclick="getLocation()">Get My Location</button>

<p id="output"></p>

<h3>Location History (Last 5)</h3>
<ul id="history"></ul>

<script>
function getLocation() {

    if (!navigator.geolocation) {
        document.getElementById("output").innerText = "Geolocation not supported";
        return;
    }

    navigator.geolocation.getCurrentPosition(success, error);
}

function success(position) {
    let lat = position.coords.latitude;
    let lon = position.coords.longitude;

    document.getElementById("output").innerText =
        `Latitude: ${lat} | Longitude: ${lon}`;

    saveLocation(lat, lon);
}

function error(err) {
    let message = "";

    switch (err.code) {
        case err.PERMISSION_DENIED:
            message = "Permission denied";
            break;
        case err.POSITION_UNAVAILABLE:
            message = "Location unavailable";
            break;
        case err.TIMEOUT:
            message = "Request timeout";
            break;
        default:
            message = "Unknown error";
    }

    document.getElementById("output").innerText = message;
}

function saveLocation(lat, lon) {

    let locations = JSON.parse(localStorage.getItem("locations")) || [];

    locations.unshift({
        latitude: lat,
        longitude: lon,
        time: new Date().toLocaleString()
    });

    if (locations.length > 5) {
        locations.pop();
    }

    localStorage.setItem("locations", JSON.stringify(locations));

    displayHistory();
}

function displayHistory() {
    let historyList = document.getElementById("history");
    historyList.innerHTML = "";

    let locations = JSON.parse(localStorage.getItem("locations")) || [];

    locations.forEach(loc => {
        let li = document.createElement("li");
        li.innerText =
            `${loc.latitude}, ${loc.longitude} (${loc.time})`;
        historyList.appendChild(li);
    });
}

window.onload = displayHistory;
</script>

</body>
</html>