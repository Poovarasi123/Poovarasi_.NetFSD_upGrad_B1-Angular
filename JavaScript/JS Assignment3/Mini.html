<!DOCTYPE html>
<html>
<head>
    <title>Mini Expense Tracker</title>
    <style>
        body { font-family: Arial; }
        input { margin: 5px; }
        button { margin: 5px; }
        #expenseList { margin-top: 15px; }
    </style>
</head>
<body>

<h2>Mini Expense Tracker</h2>

<input type="text" id="title" placeholder="Expense Title">
<input type="number" id="amount" placeholder="Amount">
<input type="date" id="date">

<br>

<button onclick="addExpense()">Add Expense</button>
<button onclick="viewExpenses()">View Expenses</button>
<button onclick="deleteExpenses()">Delete Expense</button>

<h3>Expense List:</h3>
<div id="expenseList"></div>

<script>

// Open Database
let db = openDatabase('ExpenseDB', '1.0', 'Expense Database', 2 * 1024 * 1024);

// Create Table (Transaction Handling)
db.transaction(function(tx) {
    tx.executeSql(
        'CREATE TABLE IF NOT EXISTS expenses (id INTEGER PRIMARY KEY AUTOINCREMENT, title TEXT, amount REAL, date TEXT)',
        [],
        function() { console.log("Table Created Successfully"); },
        function(tx, error) { console.log("Table Creation Error: " + error.message); }
    );
});

// Add Expense (INSERT)
function addExpense() {

    let title = document.getElementById("title").value;
    let amount = document.getElementById("amount").value;
    let date = document.getElementById("date").value;

    db.transaction(function(tx) {

        tx.executeSql(
            'INSERT INTO expenses (title, amount, date) VALUES (?, ?, ?)',
            [title, amount, date],
            function() {
                alert("Expense Added Successfully!");
                viewExpenses();
            },
            function(tx, error) {
                alert("Insert Error: " + error.message);
            }
        );

    }, function(error) {
        alert("Transaction Error: " + error.message);
    });
}

// View Expenses (SELECT)
function viewExpenses() {

    db.transaction(function(tx) {

        tx.executeSql(
            'SELECT * FROM expenses',
            [],
            function(tx, results) {

                let output = "";

                for (let i = 0; i < results.rows.length; i++) {
                    let row = results.rows.item(i);

                    output += "<p>" +
                        "Title: " + row.title +
                        " | Amount: â‚¹" + row.amount +
                        " | Date: " + row.date +
                        "</p>";
                }

                document.getElementById("expenseList").innerHTML = output;
            },
            function(tx, error) {
                alert("Select Error: " + error.message);
            }
        );

    });
}

// Delete All Expenses (DELETE)
function deleteExpenses() {

    db.transaction(function(tx) {

        tx.executeSql(
            'DELETE FROM expenses',
            [],
            function() {
                alert("All Expenses Deleted!");
                viewExpenses();
            },
            function(tx, error) {
                alert("Delete Error: " + error.message);
            }
        );

    }, function(error) {
        alert("Transaction Error: " + error.message);
    });
}

</script>

</body>
</html>