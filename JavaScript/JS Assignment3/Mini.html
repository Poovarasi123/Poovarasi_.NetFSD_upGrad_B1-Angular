<!DOCTYPE html>
<html>
<head>
  <title>Mini Expense Tracker</title>
</head>
<body>

<h2>Mini Expense Tracker</h2>

<input type="text" id="title" placeholder="Expense Title">
<input type="number" id="amount" placeholder="Amount">
<input type="date" id="date">

<button onclick="addExpense()">Add Expense</button>
<button onclick="viewExpenses()">View Expenses</button>

<ul id="expenseList"></ul>

<script>
let db;
let request = indexedDB.open("ExpenseDB", 1);

request.onupgradeneeded = function(event) {
  db = event.target.result;
  db.createObjectStore("expenses", { keyPath: "id", autoIncrement: true });
};

request.onsuccess = function(event) {
  db = event.target.result;
};

request.onerror = function() {
  alert("Database failed to open");
};

function addExpense() {
  let title = document.getElementById("title").value;
  let amount = document.getElementById("amount").value;
  let date = document.getElementById("date").value;

  if (!title || !amount || !date) {
    alert("Fill all fields");
    return;
  }

  let transaction = db.transaction(["expenses"], "readwrite");
  let store = transaction.objectStore("expenses");

  store.add({ title, amount, date });

  transaction.oncomplete = function() {
    document.getElementById("title").value = "";
    document.getElementById("amount").value = "";
    document.getElementById("date").value = "";
    viewExpenses();
  };

  transaction.onerror = function() {
    alert("Transaction failed");
  };
}

function viewExpenses() {
  let transaction = db.transaction(["expenses"], "readonly");
  let store = transaction.objectStore("expenses");
  let request = store.getAll();

  request.onsuccess = function() {
    let list = document.getElementById("expenseList");
    list.innerHTML = "";

    request.result.forEach(exp => {
      let li = document.createElement("li");
      li.innerHTML =
        exp.title + " - â‚¹" + exp.amount + " - " + exp.date +
        " <button onclick='deleteExpense(" + exp.id + ")'>Delete</button>";
      list.appendChild(li);
    });
  };
}

function deleteExpense(id) {
  let transaction = db.transaction(["expenses"], "readwrite");
  let store = transaction.objectStore("expenses");
  store.delete(id);

  transaction.oncomplete = function() {
    viewExpenses();
  };
}
</script>

</body>
</html>